(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[267],{6502:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/AdminDashboard",function(){return s(9)}])},9:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var n=s(5507),a=s(3003),r=s.n(a),i=s(7851),o=s(6392),l=s(269),u=s.n(l),c=s(5041),d=s(9269),p=s(6666),m=i.createElement;function g(){var e,t,s,a=(0,p.A)(),l=a.user,g=a.loading,f=(0,o.useRouter)(),x=(0,i.useState)([]),v=x[0],b=x[1],N=(0,i.useState)(!0),y=N[0],h=N[1],w=(0,i.useState)("all"),A=w[0],_=w[1],E=(0,i.useState)("newest"),k=E[0],C=E[1],j=(0,i.useState)("listings"),S=j[0],P=j[1];(0,i.useEffect)(function(){if(!l&&!g){d.Ay.error("You must be logged in to access the admin dashboard"),f.push("/admin-login");return}l&&D()},[l,g,f,A,k]);var D=(e=(0,n.A)(r().mark(function e(){var t,s,n;return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),t=c.N.from("listings").select("*"),"all"!==A&&(t=t.eq("status",A)),t=t.order("created_at",{ascending:"oldest"===k}),e.next=6,t;case 6:n=(s=e.sent).data,s.error?d.Ay.error("Error fetching listings"):b(n||[]),h(!1);case 11:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)}),L=(t=(0,n.A)(r().mark(function e(t){return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v.find(function(e){return e.id===t}),e.next=3,c.N.from("listings").update({status:"approved"}).eq("id",t);case 3:e.sent.error?d.Ay.error("Error approving listing"):(d.Ay.success("Listing approved successfully"),D());case 6:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),F=(s=(0,n.A)(r().mark(function e(t){return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v.find(function(e){return e.id===t}),e.next=3,c.N.from("listings").update({status:"rejected"}).eq("id",t);case 3:e.sent.error?d.Ay.error("Error rejecting listing"):(d.Ay.success("Listing rejected successfully"),D());case 6:case"end":return e.stop()}},e)})),function(e){return s.apply(this,arguments)}),R=function(e){switch(e){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}},q=function(e){switch(null==e?void 0:e.toLowerCase()){case"pro":return"bg-purple-100 text-purple-800";case"team":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return g||y?m("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},m("div",{className:"flex justify-center items-center"},m("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"}))):m("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},m("div",{className:"flex justify-between items-center mb-8"},m("h1",{className:"text-3xl font-bold text-white"},"Admin Dashboard"),m("div",{className:"flex space-x-4"},m("button",{className:"px-4 py-2 rounded-md ".concat("listings"===S?"bg-blue-600 text-white":"bg-[gray-200] text-gray-800"),onClick:function(){return P("listings")}},"Manage Listings"),m("button",{className:"px-4 py-2 rounded-md ".concat("blogs"===S?"bg-blue-600 text-white":"bg-gray-200 text-gray-800"),onClick:function(){return P("blogs")}},"Manage Blogs"))),"listings"===S&&m(i.Fragment,null,m("div",{className:"flex space-x-4 mb-8"},m("select",{value:A,onChange:function(e){return _(e.target.value)},className:"rounded-md border-gray-300"},m("option",{value:"all"},"All Status"),m("option",{value:"pending"},"Pending"),m("option",{value:"approved"},"Approved"),m("option",{value:"rejected"},"Rejected")),m("select",{value:k,onChange:function(e){return C(e.target.value)},className:"rounded-md border-gray-300"},m("option",{value:"newest"},"Newest First"),m("option",{value:"oldest"},"Oldest First"))),m("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg"},m("div",{className:"divide-y divide-gray-200"},v.map(function(e){var t;return m("div",{key:e.id,className:"p-6 hover:bg-gray-50"},m("div",{className:"flex items-center justify-between"},m("div",{className:"flex-1"},m("div",{className:"flex items-center justify-between"},m("h3",{className:"text-xl font-semibold text-gray-900"},e.title),m("div",{className:"flex space-x-2"},m("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(R(e.status))},e.status.charAt(0).toUpperCase()+e.status.slice(1)),m("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(q(e.payment_plan))},(t=e.payment_plan)?t.toUpperCase():"FREE"))),m("div",{className:"mt-2 text-sm text-gray-500"},m("p",{className:"mb-2"},e.description),m("div",{className:"grid grid-cols-2 gap-4 mt-4"},m("div",null,m("p",null,m("span",{className:"font-medium"},"Category:")," ",e.category),m("p",null,m("span",{className:"font-medium"},"Price:")," AED ",e.price),m("p",null,m("span",{className:"font-medium"},"Created:")," ",new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))),m("div",null,m("p",null,m("span",{className:"font-medium"},"Phone:")," ",e.phone||"N/A"),m("p",null,m("span",{className:"font-medium"},"Email:")," ",e.email||"N/A")))))),"pending"===e.status&&m("div",{className:"mt-4 flex justify-end space-x-4"},m("button",{onClick:function(){return L(e.id)},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500"},"Approve"),m("button",{onClick:function(){return F(e.id)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500"},"Reject")))}),0===v.length&&m("div",{className:"p-6 text-center text-gray-500"},"No listings found")))),"blogs"===S&&m("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg"},m("div",{className:"p-6"},m(u(),{href:"/admin/blog-posts",className:"block bg-[#00000091] text-white  px-4 py-2 rounded mb-4"},"Manage Blog Posts"))))}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(6502)),_N_E=e.O()}]);